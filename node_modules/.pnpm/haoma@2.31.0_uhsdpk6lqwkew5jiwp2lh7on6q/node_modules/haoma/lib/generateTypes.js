"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const pkg_dir_1 = tslib_1.__importDefault(require("pkg-dir"));
const fs_1 = require("fs");
const path_1 = require("path");
const appRoot = pkg_dir_1.default.sync(path_1.join(__dirname, '../..'));
if (appRoot) {
    const nodeModulesPath = path_1.join(appRoot, 'node_modules');
    const typesPath = path_1.join(nodeModulesPath, '@types');
    const generatedHaomaTypesPath = path_1.join(typesPath, 'generated__haoma');
    for (const path of [nodeModulesPath, typesPath, generatedHaomaTypesPath]) {
        if (!fs_1.existsSync(path)) {
            fs_1.mkdirSync(path);
        }
    }
    fs_1.writeFileSync(path_1.join(generatedHaomaTypesPath, 'index.d.ts'), `
      import 'haoma/lib/jestSetup'
    `);
    fs_1.writeFileSync(path_1.join(generatedHaomaTypesPath, 'package.json'), JSON.stringify({
        name: '@types/generated__haoma',
        version: '0.0.0',
        description: 'GENERATED BY HAOMA.',
        main: '',
        types: 'index.d.ts',
    }, null, 2));
}
